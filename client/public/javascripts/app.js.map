{"version":3,"sources":["app/application.js","app/initialize.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAhIA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AALA;AAAA","file":"public\\javascripts\\app.js","sourcesContent":["\r\nvar run_controls = function() {\r\n    // Get fqdn from CozyDB\r\n    $.get(\"./debian/controls\")\r\n\t\t.done(function( data ) {\r\n\t\t\t// update view\r\n\t\t\t$(\"#main-buttons\").show();\r\n\r\n\t\t\tshow_halt_reboot_buttons();\r\n\r\n\t\t\trefresh_fqdn();\r\n\t\t\t$(\"#button-refresh\").click(function() {\r\n\t\t\t  refresh_fqdn();\r\n\t\t\t});\r\n\t\t\t$(\"#button-reconfigure\").click(function() {\r\n\t\t\t  save_fqdn();\r\n\t\t\t});\r\n\t\t\t$(\"#button-db-compact\").click(function() {\r\n\t\t\t  database_maintenance(\"compact\");\r\n\t\t\t});\r\n\t\t\t$(\"#button-db-compact-views\").click(function() {\r\n\t\t\t  database_maintenance(\"views\");\r\n\t\t\t});\r\n\t\t\t$(\"#button-db-cleanup\").click(function() {\r\n\t\t\t  database_maintenance(\"cleanup\");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#button-halt\").confirmation({\r\n\t\t\t\"title\": \"Do you really want to halt the host ?\",\r\n\t\t\t\"btnOkClass\": \"btn-danger\",\r\n\t\t\t\"btnCancelClass\": \"btn-info\",\r\n\t\t\t\"btnOkLabel\": \"SHUTDOWN\",\r\n\t\t\t\"btnCancelLabel\": \"CANCEL\",\r\n\t\t\t\"placement\": \"bottom\",\r\n\t\t\t\"popout\": true,\r\n\t\t\t\"singleton\": true,\r\n\t\t\t\"onConfirm\": host_halt\r\n\t\t\t});\r\n\t\t\t$(\"#button-reboot\").confirmation({\r\n\t\t\t\"title\": \"Do you really want to reboot the host ?\",\r\n\t\t\t\"btnOkClass\": \"btn-warning\",\r\n\t\t\t\"btnCancelClass\": \"btn-info\",\r\n\t\t\t\"btnOkLabel\": \"REBOOT\",\r\n\t\t\t\"btnCancelLabel\": \"CANCEL\",\r\n\t\t\t\"placement\": \"bottom\",\r\n\t\t\t\"popout\": true,\r\n\t\t\t\"singleton\": true,\r\n\t\t\t\"onConfirm\": host_reboot\r\n\t\t\t});\r\n\t\t});\r\n};\r\n\r\nvar refresh_fqdn = function() {\r\n    // Get fqdn from CozyDB\r\n    $.get(\"./debian/fqdn\")\r\n\t\t.done(function( data ) {\r\n\t\t\t$(\"#input-fqdn\").val(data);\r\n\t\t})\r\n\t\t.fail(function( data ) {\r\n\t\t});\r\n};\r\n\r\nvar save_fqdn = function() {\r\n    // Get new value in input text\r\n    var form_value = $(\"#input-fqdn\").val();\r\n    // Push configuration\r\n    $.post(\"./debian/fqdn\", {fqdn: form_value}, function(data) {\r\n        $(\"#div-status-ko\").hide();\r\n        $(\"#div-status-ok\").html(data.message).show();\r\n    });\r\n};\r\n\r\nvar host_halt = function() {\r\n\t// ask for halt host\r\n\t$(\"#button-halt\").confirmation('hide')\r\n    $.get(\"./debian/host/halt\", function(data) {\r\n        $(\"#div-status-ko\").hide();\r\n        $(\"#div-status-ok\").html(data.message).show();\r\n    });\r\n};\r\n\r\nvar host_reboot = function() {\r\n\t// ask for halt host\r\n\t$(\"#button-reboot\").confirmation('hide')\r\n    $.get(\"./debian/host/reboot\", function(data) {\r\n        $(\"#div-status-ko\").hide();\r\n        $(\"#div-status-ok\").html(data.message).show();\r\n    });\r\n};\r\n\r\nvar show_halt_reboot_buttons = function() {\r\n    // Get fqdn from CozyDB\r\n    $.get(\"./debian/host/isvps\", function(data) {\r\n        if (data.isVPS === false) {\r\n\t\t\t$(\"#button-halt-reboot-div\").show();\r\n        }\r\n    });\r\n};\r\n\r\nvar database_maintenance = function(option) {\r\n\tvar url = \"./debian/database/\"+option;\r\n\r\n\t$(\"#div-status-ko\").hide();\r\n\t$(\"#div-status-ok\").html('Database maintenance operation \"' + option + '\" is running...').show();\r\n\r\n    $.get(url, function(data) {\r\n        $(\"#div-status-ko\").hide();\r\n        $(\"#div-status-ok\").html(data.message).show();\r\n    });\r\n};\r\n\r\nvar Application = {\r\n  initialize: function () {\r\n\t  run_controls();\r\n\r\n      $(document).ajaxError(function(event, jqxhr, settings, thrownError) {\r\n        $(\"#div-status-ok\").hide();\r\n\t\tvar data = JSON.parse(jqxhr.responseText);\r\n\t\tif (data.message) {\r\n\t\t\t$(\"#div-status-ko\").html(thrownError + ':<br/>\\n' + data.message).show();\r\n\t\t} else {\r\n\t\t\t$(\"#div-status-ko\").html(thrownError + ':<br/>\\n' + jqxhr.responseText).show();\r\n\t\t}\r\n      });\r\n  }\r\n};\r\n\r\nmodule.exports = Application;\r\n","var application = require('application');\r\n\r\n$(function () {\r\n  application.initialize();\r\n});\r\n"]}